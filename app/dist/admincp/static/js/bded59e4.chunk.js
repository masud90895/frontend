"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-feed-blocks-StatusComposer-Block"],{40427:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var r=a(43961),o=a(1530),n=a(25304),i=a(41349),l=a(69508),s=a(22463),p=a(52520),d=a(99221),m=a(4633),c=a.n(m),u=a(30758),f=a(28059),g=a(26327),v=a(86725);let y=(0,l.Ay)(v.A,{name:"StatusControl",slot:"Control",shouldForwardProp:e=>"canUploadTypes"!==e})(({theme:e})=>({width:32,height:32,fontSize:e.mixins.pxToRem(20),[e.breakpoints.up("sm")]:{width:44,height:44}}));function h({icon:e,testid:t,...a}){return u.createElement(y,{"data-testid":t,color:"primary",...a},u.createElement(n.s4,{icon:e}))}var b=a(32758);let x="block",C=(0,l.Ay)("div",{name:"AvatarWrapper"})(({theme:e})=>({marginRight:e.spacing(1.5)})),k=(0,l.Ay)("div",{name:"ComposerWrapper"})(({theme:e})=>({display:"flex",width:"100%",alignItems:"center",minWidth:0,[e.breakpoints.down("sm")]:{display:"block",width:"100%"}})),w=(0,l.Ay)("div",{name:"LayoutSlot",slot:"ComposerInput",overridesResolver(e,t){return[t.composerInput]}})(({theme:e})=>({border:e.mixins.border("secondary"),flex:1,backgroundColor:e.palette.action.hover,height:e.spacing(6),borderRadius:24,padding:e.spacing(0,3),cursor:"pointer",color:e.palette.text.secondary,fontSize:e.mixins.pxToRem(15),fontWeight:e.typography.fontWeightRegular,letterSpacing:0,WebkitBoxOrient:"vertical",WebkitLineClamp:"1",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",lineHeight:e.mixins.pxToRem(48),"*":{margin:"0 !important"},[e.breakpoints.down("sm")]:{height:e.spacing(4),lineHeight:e.mixins.pxToRem(32),padding:e.spacing(0,2)}})),E=(0,l.Ay)("div",{name:"ComposerToolbar"})(({theme:e})=>({display:"flex",marginLeft:e.spacing(1.5),[e.breakpoints.down("sm")]:{marginLeft:e.spacing(0),marginTop:e.spacing(1.5),"& > *":{marginRight:`${e.spacing(1.5)} !important`}}})),_=(0,l.Ay)("div",{name:"ComposerToolbarExpand"})(({theme:e})=>{var t;return{display:"flex",borderTop:"solid 1px",borderTopColor:null==(t=e.palette.border)?void 0:t.secondary,marginTop:e.spacing(2),marginLeft:e.spacing(8),paddingTop:e.spacing(1)}}),A=(0,r.$MH)((0,r.FB$)(function({item:e,title:t,variant:a,blockProps:l,showWhen:m}){var v,y;let A,[S,,T]=(0,g.A)(),{i18n:R,useSession:W,dispatch:H,jsxBackend:B,usePageParams:I,getAcl:L,getSetting:D}=(0,r.PCX)(),P=(0,s.A)(),z=(0,p.A)(P.breakpoints.down("sm")),U=L(),F=L("activity.feed.create"),M=D(),{user:$,loggedIn:O}=W(),V=I(),q=R.formatMessage({id:"what_s_your_mind"},{user:null==$?void 0:$.full_name}),X=(0,r.dx2)("formValues.dialogStatusComposer")||q,{identity:j,item_type:G}=V,J=j?j.split(".")[3]:"",K="user"===G&&J&&(null==$?void 0:$.id)!==parseInt(J);u.useEffect(()=>{O&&H({type:"setting/sharingItemPrivacy/FETCH",payload:{id:null==$?void 0:$.id}})},[O]),T.current.requestComposerUpdate=u.useCallback(()=>{setImmediate(()=>{let{attachmentType:e,attachments:t}=T.current.state;H({type:"statusComposer/onPress/status",payload:{data:{attachmentType:e,attachments:{[e]:t[e]}},parentIdentity:j,parentType:G}})})},[T,H,j,G]),((null==e?void 0:e.privacy_feed)||(null==e?void 0:e.privacy_detail))&&(A={privacy_feed:null==e?void 0:e.privacy_feed,privacy_detail:null==e?void 0:e.privacy_detail});let N=()=>{H({type:"statusComposer/onPress/status",payload:{parentIdentity:j,parentType:G,data:A}})},Q=()=>{T.current.removeAttachments()},Y=u.useMemo(()=>({strategy:x,acl:U,setting:M,isUserProfileOther:K,item:e,parentType:G}),[U,M,K,e,G]),Z=(0,i.Ue)(f.A.attachers,Y);if(c()($)||!F||(null==e||null==(v=e.profile_settings)?void 0:v.profile_view_profile)===!1||(null==e||null==(y=e.profile_settings)?void 0:y.feed_share_on_wall)===!1||!(0,i.Ue)([{showWhen:m}],{item:e}).length)return null;if("expanded"===a)return u.createElement(o.eB,{testid:"blockStatusComposer"},u.createElement(o.Tw,{title:t}),u.createElement(o.tD,null,u.createElement(d.A,{display:"flex",flexDirection:"row"},u.createElement(C,null,u.createElement(n.H8,{user:$,size:z?32:48,"data-testid":"userAvatar",noStory:!0,showStatus:!1})),u.createElement(w,{"data-testid":"whatsHappening",color:"info",onClick:N},u.createElement(b.Ay,{html:X}))),u.createElement(_,{onClick:Q},Z.map(e=>B.render({component:e.as,props:{key:e.as,strategy:x,composerRef:T,composerState:S,control:h,parentIdentity:j}})))));let ee=z?Z:Z.slice(0,3);return u.createElement(o.eB,{testid:"blockStatusComposer"},u.createElement(o.Tw,{title:t}),u.createElement(o.tD,null,u.createElement(d.A,{display:"flex",flexDirection:"row"},u.createElement(C,null,u.createElement(n.H8,{user:$,size:z?32:48,"data-testid":"userAvatar",noStory:!0,showStatus:!1})),u.createElement(k,null,u.createElement(w,{"data-testid":"whatsHappening",onClick:N},u.createElement(b.Ay,{html:X})),u.createElement(E,{"data-testid":"composerToolbar",onClick:Q},ee.map(e=>B.render({component:e.as,props:{key:e.as,strategy:x,composerRef:T,composerState:S,control:h,parentIdentity:j}})))))))},()=>{}));var S=(0,r.WvA)({extendBlock:A,name:"StatusComposer",testid:"StatusComposer",defaults:{variant:"default",title:"Status Composer",blockLayout:"Status Composer"},custom:{variant:{name:"variant",component:"Select",label:"Variant",fullWidth:!0,margin:"normal",variant:"outlined",options:[{label:"Default",value:"default"},{label:"Expanded",value:"expanded"}]}}})}}]);