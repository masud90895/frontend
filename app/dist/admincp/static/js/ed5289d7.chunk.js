(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-PhotoViewDetail-index"],{18313:function(e,t,o){"use strict";var n=o(43961),i=o(88273),l=o.n(i),a=o(20644),r=o.n(a),d=o(65663);t.A=(0,n.NgA)((e,{photo_set:t,photo_album:o,identity:n,photo_id:i,media_type:a})=>{var s,u;let p=r()(e,n);if(!p)return{};let[h,c]=o?[d.hO,o]:t?[d.HN,t]:[],v=(r()(e,`photo.entities.${h}.${c}.photos`)||[]).filter(t=>{if(!r()(e,t).error)return t}),m=(null==p?void 0:p.user)?r()(e,p.user):void 0,f=null==v?void 0:v.length,w=1<f?l()(v,e=>e===n):-1,x=p.user_tags?p.user_tags.map(t=>r()(e,t)).filter(Boolean):[],g={item:p,photos:v,user:m,photo_id:i,user_tags:x,mediaType:a,nextUrl:void 0,prevUrl:void 0,shouldPreload:((e,t,o=3)=>t<o?"prev":t>e-o-1?"next":"")(f,w),fromResource:h,fromResourceId:c};if(-1<w){let n="/photo";if(t&&(n=`/media/${t}`),o&&(n=`/media/album/${o}`),w<f-1){let t=v[w+1],o=t.split(".")[2],i=null==(s=r()(e,t))?void 0:s.slug;g.nextUrl=`${n}/${o}/${t.replace(`${o}.entities.${o}.`,"")}${i?`/${i}`:""}`}if(0<w){let t=v[w-1],o=null==(u=r()(e,t))?void 0:u.slug,i=t.split(".")[2];g.prevUrl=`${n}/${i}/${t.replace(`${i}.entities.${i}.`,"")}${o?`/${o}`:""}`}}return g})},56314:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return p}});var n=o(43961),i=o(65663),l=o(69508),a=o(99221),r=o(30758);let d="PhotoViewContainer",s=(0,l.Ay)(a.A,{name:d,slot:"root"})(({theme:e})=>({width:"100%",height:"100%",padding:"0 !important",paddingTop:"0 !important",display:"flex",overflowY:"visible",background:e.palette.background.paper,outline:"none !important",[e.breakpoints.down("md")]:{height:"auto",flexFlow:"column",flexDirection:"column","& > div":{overflow:"inherit"}}})),u=(0,l.Ay)("div",{name:d,slot:"dialogStatistic",shouldForwardProp:e=>"isExpand"!==e})(({theme:e,isExpand:t})=>({display:t?"none":"block",height:"100%",width:"480px",[e.breakpoints.down("md")]:{width:"35%"},[e.breakpoints.down("sm")]:{width:"45%"},[e.breakpoints.down("xs")]:{width:"100%",height:"420px"}}));var p=(0,o(18313).A)(function({item:e,identity:t,nextUrl:o,prevUrl:l,mediaType:a,loading:d,sx:p,shouldPreload:h,fromResource:c,fromResourceId:v}){var m;let{jsxBackend:f,dispatch:w,navigate:x}=(0,n.PCX)(),g=(0,n.zy2)(),[k,y]=r.useState(!1),$=f.get("photo.view.sideBlock"),b=f.get("media.ui.viewSet");r.useEffect(()=>{h&&w({type:`photo/${c}/LOAD`,payload:{identity:t,direction:h,[c]:v}})},[h]);let E=r.useCallback(e=>{var t;x({pathname:e},{replace:!0,state:{asModal:null==g||null==(t=g.state)?void 0:t.asModal}})},[x,null==g||null==(m=g.state)?void 0:m.asModal]);return(r.useEffect(()=>{let e=e=>{39===e.keyCode&&o?E(o):37===e.keyCode&&l&&E(l)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o,l]),e)?r.createElement(s,{sx:p},r.createElement(b,{mediaType:a,identity:t,onAddPhotoTag:e=>{w({type:i.kx,payload:{identity:t,data:e}})},onRemovePhotoTag:e=>{w({type:i.R9,payload:{identity:t,id:e}})},onMinimizePhoto:e=>{y(e)},onArrowClick:E,nextUrl:o,prevUrl:l,sx:{flex:1,minWidth:0}}),r.createElement(u,{isExpand:k},$?r.createElement($,{loading:d,identity:t}):null)):null})},88273:function(e,t,o){var n=o(49667),i=o(85525),l=o(8825),a=Math.max;e.exports=function(e,t,o){var r=null==e?0:e.length;if(!r)return -1;var d=null==o?0:l(o);return d<0&&(d=a(r+d,0)),n(e,i(t,3),d)}}}]);